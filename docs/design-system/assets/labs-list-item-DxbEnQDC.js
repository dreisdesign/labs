class l extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this._id=this.getAttribute("data-id")||`item-${Math.random().toString(36).slice(2,9)}`,this._value=this.getAttribute("value")||this.textContent||"",this._timestamp=this.getAttribute("timestamp")||null,this._date=this.getAttribute("date")||null,this._checked=this.hasAttribute("checked"),this.render()}connectedCallback(){this.render()}static get observedAttributes(){return["value","checked","archived","restored","timestamp","date"]}attributeChangedCallback(t,r,s){t==="value"&&(this._value=s),t==="timestamp"&&(this._timestamp=s),t==="date"&&(this._date=s),t==="checked"&&(this._checked=this.hasAttribute("checked")),this.render()}render(){if(!this.shadowRoot.innerHTML){this.shadowRoot.innerHTML=`
        <style>
          :host { display: block; font-family: var(--font-family-base, system-ui, sans-serif); }
          .row { display:flex; align-items:center; gap:12px; padding:10px 12px; border-radius:12px; background:var(--color-surface, #fff); width:100%; box-sizing:border-box; }
          .text { flex:1; font-size:1rem; color:var(--color-on-surface, #111); word-break:break-word; }
          .timestamp { font-size:0.75rem; color:var(--color-on-surface-variant, #666); margin-left:6px; }
          .badge { font-size:0.625rem; padding:4px 8px; border-radius:999px; background:var(--color-surface-secondary, #f1f3f4); color:var(--color-on-surface); margin-left:8px; }
          .actions { display:flex; gap:8px; align-items:center; }
          labs-button[variant="icon"] { --icon-size:20px; }
          .secondary-variant { background: var(--color-surface-secondary, #f6f7f8); }
        </style>
        <div class="row" role="listitem" data-id="${this._id}">
          <labs-checkbox id="chk" aria-label="Toggle complete"></labs-checkbox>
          <div style="display:flex;flex-direction:column;flex:1;">
            <div class="text"></div>
            <div class="timestamp" aria-hidden="true"></div>
          </div>
          <div id="archivedBadgeContainer" aria-hidden="true"></div>
          <div class="actions">
            <labs-button id="archiveBtn" variant="icon" aria-label="Archive">
              <labs-icon id="archiveIcon" slot="icon-left" name="archive" width="20" height="20"></labs-icon>
            </labs-button>
            <labs-button id="deleteBtn" variant="icon" aria-label="Delete">
              <labs-icon slot="icon-left" name="delete_forever" width="20" height="20"></labs-icon>
            </labs-button>
          </div>
        </div>
      `;const a=this.shadowRoot.getElementById("chk");a&&a.addEventListener("change",d=>{this._checked=!!d.detail&&!!d.detail.checked,this._checked?this.setAttribute("checked",""):this.removeAttribute("checked"),this.dispatchEvent(new CustomEvent("toggle",{detail:{checked:this._checked,id:this._id},bubbles:!0,composed:!0}))});const c=this.shadowRoot.getElementById("archiveBtn");c&&c.addEventListener("click",()=>{this.hasAttribute("archived")&&!this.hasAttribute("restored")?(this.setAttribute("restored",""),this.dispatchEvent(new CustomEvent("request-restore-copy",{detail:{value:this._value,id:this._id},bubbles:!0,composed:!0}))):this.hasAttribute("archived")||this._archive()});const n=this.shadowRoot.getElementById("deleteBtn");n&&n.addEventListener("click",()=>this._remove())}const t=this.shadowRoot.getElementById("chk");if(t){this._checked?t.setAttribute("checked",""):t.removeAttribute("checked");const a=(()=>{if(!this._date)return!1;try{const c=new Date(this._date+"T00:00:00"),d=new Date().toISOString().slice(0,10);return c.toISOString().slice(0,10)!==d}catch{return!1}})();this.hasAttribute("archived")||a?t.setAttribute("inactive",""):t.removeAttribute("inactive")}const r=this.shadowRoot.querySelector(".text");r&&(r.textContent=this._value);const s=this.shadowRoot.querySelector(".timestamp");s&&(s.textContent=this._timestamp?this._formatTimestamp(this._timestamp):"");const e=this.shadowRoot.getElementById("archiveIcon"),i=this.shadowRoot.getElementById("archiveBtn"),o=this.shadowRoot.querySelector(".row");this.hasAttribute("restored")?(e&&(e.setAttribute("name","history"),e.setAttribute("color","var(--color-on-surface)"),e.style.opacity="0.45"),i&&(i.setAttribute("aria-label","Already restored"),i.setAttribute("disabled",""),i.style.pointerEvents="none"),o&&(o.style.opacity="var(--labs-archived-opacity, 0.7)")):this.hasAttribute("archived")?(e&&(e.setAttribute("name","history"),e.setAttribute("color","var(--color-on-surface)"),e.style.opacity="1"),i&&(i.setAttribute("aria-label","Restore"),i.style.pointerEvents="",i.removeAttribute("disabled")),o&&(o.style.opacity="var(--labs-archived-opacity, 0.7)")):(e&&(e.setAttribute("name","archive"),e.setAttribute("color","var(--color-on-surface)"),e.style.opacity="1"),i&&(i.setAttribute("aria-label","Archive"),i.removeAttribute("disabled"),i.style.pointerEvents=""),o&&(o.style.opacity="",o.classList.remove("secondary-variant")));const h=this.shadowRoot.getElementById("archivedBadgeContainer");if(h&&(h.innerHTML="",this.hasAttribute("archived"))){const a=document.createElement("span");a.className="badge",a.textContent="Archived",h.appendChild(a)}}_formatTimestamp(t){try{const r=new Date(t),s=r.getHours().toString().padStart(2,"0"),e=r.getMinutes().toString().padStart(2,"0");return`${s}:${e}`}catch{return t}}_toggle(){this._checked=!this._checked,this._checked?this.setAttribute("checked",""):this.removeAttribute("checked");const t=this.shadowRoot&&this.shadowRoot.getElementById&&this.shadowRoot.getElementById("chk");t&&t.setAttribute("aria-checked",String(this._checked)),this.dispatchEvent(new CustomEvent("toggle",{detail:{checked:this._checked,id:this._id},bubbles:!0,composed:!0})),this.render()}_archive(){this.setAttribute("archived",""),this.dispatchEvent(new CustomEvent("archive",{detail:{value:this._value,id:this._id},bubbles:!0,composed:!0}))}_restore(){this.hasAttribute("restored")||(this.removeAttribute("archived"),this.setAttribute("restored",""),this.dispatchEvent(new CustomEvent("restore",{detail:{value:this._value,id:this._id},bubbles:!0,composed:!0})))}_remove(){this.dispatchEvent(new CustomEvent("remove",{detail:{value:this._value,id:this._id},bubbles:!0,composed:!0}))}get value(){return this._value}set value(t){this._value=t,this.setAttribute("value",t)}}customElements.get("labs-list-item")||customElements.define("labs-list-item",l);
