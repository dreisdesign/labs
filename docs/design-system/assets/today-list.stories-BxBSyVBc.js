import"./labs-input-96kRE3BN.js";import"./labs-card-B1H2P0RF.js";import"./labs-toast-fgwwwf7I.js";class m extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this._items=[],this._deleted=null;const t=document.createElement("style");t.textContent=`:host{display:block;max-width:720px;margin:0 auto;font-family:inherit;color:var(--color-on-surface)}
header{display:flex;align-items:center;justify-content:space-between;margin:0 0 var(--space-4,16px) 0}
.list{display:flex;flex-direction:column;gap:12px}
.empty{color:var(--color-on-surface, #6b7280);text-align:center;padding:32px 12px;border-radius:var(--radius-1,8px);background:color-mix(in srgb,var(--color-surface) 90%, transparent)}
.controls{display:flex;gap:12px;align-items:center}
`;const e=document.createElement("div");e.className="container";const s=document.createElement("header"),n=document.createElement("h2");n.textContent="Today",n.setAttribute("part","title");const a=document.createElement("div");a.className="controls",this._input=document.createElement("labs-input"),this._input.setAttribute("placeholder","Add item and press Enter"),a.appendChild(this._input),s.appendChild(n),s.appendChild(a);const i=document.createElement("div");i.className="list",this._list=i,this.hasAttribute("hide-header")||e.appendChild(s),e.appendChild(i),this.shadowRoot.appendChild(t),this.shadowRoot.appendChild(e),this._onSubmit=this._onSubmit.bind(this)}connectedCallback(){try{this._input&&!this.hasAttribute("hide-header")&&this._input.addEventListener("submit",this._onSubmit)}catch{}this._load(),this._ensureToast(),this._render()}disconnectedCallback(){try{this._input&&this._input.removeEventListener("submit",this._onSubmit)}catch{}}_ensureToast(){if(!document.body.querySelector("labs-toast")){const t=document.createElement("labs-toast");document.body.appendChild(t)}this._toast=document.body.querySelector("labs-toast")}_save(){try{localStorage.setItem("today-list-items",JSON.stringify(this._items))}catch{}}_load(){try{const t=localStorage.getItem("today-list-items");t&&(this._items=JSON.parse(t))}catch{this._items=[]}}_onSubmit(t){const e=t&&t.detail&&t.detail.value&&t.detail.value.trim();if(!e)return;const s=Date.now();if(this._lastAdd||(this._lastAdd={value:"",ts:0}),this._lastAdd.value===e&&s-this._lastAdd.ts<500)return;this._lastAdd.value=e,this._lastAdd.ts=s;const n={id:Date.now()+Math.random().toString(36).slice(2,7),text:e,completed:!1,createdAt:Date.now()};this._items.unshift(n),this._save(),this._render()}openInput(){try{this.dispatchEvent(new CustomEvent("request-open-input",{bubbles:!0,composed:!0}))}catch{}}addItem(t){const e=t&&String(t).trim();if(!e)return;const s=Date.now();if(this._lastAdd||(this._lastAdd={value:"",ts:0}),this._lastAdd.value===e&&s-this._lastAdd.ts<500)return;this._lastAdd.value=e,this._lastAdd.ts=s;const n={id:Date.now()+Math.random().toString(36).slice(2,7),text:e,completed:!1,createdAt:Date.now()};this._items.unshift(n),this._save(),this._render()}_render(){if(this._list.innerHTML="",!this._items.length){const t=document.createElement("div");t.className="empty",t.textContent="No items yet â€” add something using the input above.",this._list.appendChild(t);return}this._items.forEach((t,e)=>{const s=document.createElement("labs-card"),n=document.createElement("div");n.slot="header",n.textContent=t.text,n.style.textDecoration=t.completed?"line-through":"none";const a=document.createElement("div");a.slot="",a.textContent=`Added ${new Date(t.createdAt).toLocaleString()}`;const i=document.createElement("div");i.slot="actions";const o=document.createElement("button");o.type="button",o.textContent=t.completed?"Mark undone":"Mark done",o.addEventListener("click",()=>{t.completed=!t.completed,this._save(),this._render()});const d=document.createElement("button");d.type="button",d.textContent="Edit",d.addEventListener("click",()=>{const l=prompt("Edit item",t.text);l!=null&&(t.text=l.trim(),this._save(),this._render())});const r=document.createElement("button");r.type="button",r.textContent="Delete",r.addEventListener("click",()=>this._deleteWithUndo(t,e)),i.appendChild(o),i.appendChild(d),i.appendChild(r),s.appendChild(n),s.appendChild(a),s.appendChild(i),this._list.appendChild(s)})}_deleteWithUndo(t,e){const s=this._items.splice(e,1)[0];if(this._save(),this._render(),this._toast){this._toast.show("Item deleted",{actionText:"Undo",duration:5e3});const n=()=>{this._items.splice(e,0,s),this._save(),this._render(),i()},a=()=>{i()},i=()=>{this._toast.removeEventListener("action",n),this._toast.removeEventListener("dismiss",a)};this._toast.addEventListener("action",n,{once:!0}),this._toast.addEventListener("dismiss",a,{once:!0})}}}customElements.get("today-list-app")||customElements.define("today-list-app",m);const v={title:"Apps/Today List"},c=()=>document.createElement("today-list-app");c.parameters={...c.parameters,docs:{...c.parameters?.docs,source:{originalSource:`() => {
  const el = document.createElement('today-list-app');
  return el;
}`,...c.parameters?.docs?.source}}};const b=["Default"];export{c as Default,b as __namedExportsOrder,v as default};
