<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labs: Today-List</title>

    <script>
        // Set flavor/theme classes as early as possible for CSS tokens
        (function () {
            var root = document.documentElement;
            var flavor = localStorage.getItem('today-list-flavor') || 'blueberry';
            var theme = localStorage.getItem('today-list-theme') || 'light';
            root.classList.remove('flavor-blueberry', 'flavor-strawberry', 'flavor-vanilla');
            root.classList.remove('theme-light', 'theme-dark');
            root.classList.add('flavor-' + flavor);
            root.classList.add('theme-' + theme);
            root.setAttribute('data-color-scheme', theme);
        })();
    </script>

    <!-- Design System Tokens -->
    <link rel="stylesheet" href="../design-system/tokens/colors.css">
    <link rel="stylesheet" href="../design-system/tokens/spacing.css">
    <link rel="stylesheet" href="../design-system/tokens/typography.css">
    <link rel="stylesheet" href="../design-system/tokens/border-radius.css">
    <link rel="stylesheet" href="../design-system/tokens/shadows.css">
    <link rel="stylesheet" href="../design-system/styles/flavors.css">

    <!-- Components -->
    <script type="module" src="../design-system/components/labs-container.js"></script>
    <script type="module" src="../design-system/components/labs-footer-with-settings.js"></script>
    <script type="module" src="../design-system/components/labs-template-header.wrapped.js"></script>
    <script type="module" src="../design-system/components/labs-metric-card.js"></script>
    <script type="module" src="../design-system/components/labs-card.js"></script>
    <script type="module" src="../design-system/components/labs-list-item.js"></script>
    <script type="module" src="../design-system/components/labs-dropdown.js"></script>
    <script type="module" src="../design-system/components/labs-icon.js"></script>
    <script type="module" src="../design-system/components/labs-button.js"></script>
    <script type="module" src="../design-system/components/labs-toast.js"></script>
    <script type="module" src="../design-system/components/labs-overlay.js"></script>
    <script type="module" src="../design-system/components/labs-input-card.js"></script>
    <script type="module" src="../design-system/components/labs-details.js"></script>

    <!-- Today-List Logic -->
    <script type="module" src="./js/main.js"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: var(--color-background);
            color: var(--color-on-surface);
            font-family: var(--font-family-base);
        }

        labs-container {
            flex: 1;
            display: block;
        }

        .todo-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            margin-top: var(--space-md);
        }

        .archived-section {
            margin-top: var(--space-lg);
        }

        labs-metric-card {
            margin-bottom: var(--space-md);
        }

        labs-footer-with-settings {
            margin-top: auto;
        }

        /* Position toast above the footer */
        labs-toast {
            --toast-bottom: 120px;
        }
    </style>
</head>

<body>
    <labs-container padding-md>
        <labs-template-header-wrapped>
            <span slot="title">Today</span>
            <span slot="subtitle" id="current-date"></span>
        </labs-template-header-wrapped>

        <labs-metric-card id="todo-metric">
            <span slot="label">Tasks</span>
            <span slot="value">0</span>
        </labs-metric-card>

        <!-- Active todos -->
        <div class="todo-list" id="todo-list">
            <!-- Active todo items will be inserted here -->
        </div>

        <!-- Archived todos (collapsible) -->
        <div class="archived-section" id="archived-section">
            <!-- Archived items will be inserted here if any exist -->
        </div>
    </labs-container>

    <labs-footer-with-settings elevated></labs-footer-with-settings>

    <!-- Input overlay for adding new todos -->
    <labs-overlay id="input-overlay" size="medium" transparent>
        <labs-input-card></labs-input-card>
    </labs-overlay>

    <script>
        // Set current date in header
        document.addEventListener('DOMContentLoaded', function () {
            var dateEl = document.getElementById('current-date');
            if (dateEl) {
                var now = new Date();
                dateEl.textContent = now.toLocaleDateString(undefined, {
                    weekday: 'long',
                    month: 'long',
                    day: 'numeric'
                });
            }
        });
    </script>
</body>

</html>